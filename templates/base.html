<!DOCTYPE html>
<html lang="ru" data-theme="{{ current_user.theme if current_user.is_authenticated else 'light' }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}–§–æ—Ä—É–º 4–ñ –∫–ª–∞—Å—Å–∞{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    {% if current_user.is_authenticated %}
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>4–ñ –ö–ª–∞—Å—Å</h2>
            </div>
            
            <nav class="sidebar-nav">
                <a href="{{ url_for('index') }}" class="nav-item {% if request.endpoint == 'index' %}active{% endif %}">
                    <span>üè†</span>
                    <span>–ì–ª–∞–≤–Ω–∞—è</span>
                </a>
                <a href="{{ url_for('homework') }}" class="nav-item {% if request.endpoint == 'homework' %}active{% endif %}">
                    <span>üìö</span>
                    <span>–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ</span>
                </a>
                <a href="{{ url_for('info') }}" class="nav-item {% if request.endpoint == 'info' %}active{% endif %}">
                    <span>‚ÑπÔ∏è</span>
                    <span>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</span>
                </a>
                <a href="{{ url_for('chat') }}" class="nav-item {% if request.endpoint == 'chat' %}active{% endif %}">
                    <span>üí¨</span>
                    <span>–ß–∞—Ç –∫–ª–∞—Å—Å–∞</span>
                </a>
                <a href="{{ url_for('messages') }}" class="nav-item {% if request.endpoint == 'messages' %}active{% endif %}">
                    <span>‚úâÔ∏è</span>
                    <span>–õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</span>
                </a>
                
                {% if current_user.role == 'admin' %}
                <a href="{{ url_for('admin') }}" class="nav-item admin-item {% if request.endpoint == 'admin' %}active{% endif %}">
                    <span>‚öôÔ∏è</span>
                    <span>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</span>
                </a>
                {% endif %}
            </nav>
            
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar">
                        {{ current_user.first_name[0] }}{{ current_user.last_name[0] }}
                    </div>
                    <div class="user-details">
                        <div class="user-name">{{ current_user.get_full_name() }}</div>
                        <div class="user-role">
                            {% if current_user.role == 'admin' %}
                            <span class="admin-badge">–ê–¥–º–∏–Ω</span>
                            {% else %}
                            –£—á–µ–Ω–∏–∫
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="sidebar-actions">
                    <button id="themeToggle" class="theme-btn">
                        <span class="theme-icon">üåô</span>
                    </button>
                    <a href="{{ url_for('logout') }}" class="logout-btn">
                        <span>üö™</span>
                    </a>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <div class="content-header">
                <h1>{% block page_title %}–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞{% endblock %}</h1>
                {% block header_actions %}{% endblock %}
            </div>
            
            <div class="content">
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="alert alert-{{ category }}">{{ message }}</div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}
                
                {% block content %}{% endblock %}
            </div>
        </main>
    </div>
    {% else %}
        {% block auth_content %}{% endblock %}
    {% endif %}

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    {% block scripts %}{% endblock %}
</body>
</html>